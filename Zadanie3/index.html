<!doctype html>
<html lang="en">

<head>
  <!-- Required meta tags -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <!-- Bootstrap CSS -->
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css"
    integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">

  <title>Listing + details!</title>
</head>

<body>

  <div>
    <div class="container">
      <p id="weather">test</p>
      <form id="mainForm" class="needs-validation" novalidate>
        <div class="form-group">
          <label for="inputFirstname" data-error="Firstname2" data-success="What a good Firstname">Firstname</label>
          <div class="input-group">
      
            <input type="text" class="form-control" id="inputFirstname" oninput="checkFirstname()" required
              aria-describedby="inputFirstnameHelp" placeholder="Enter firstname" pattern="[a-zA-Z]{3,}">
              <div class="invalid-tooltip">
                  Your firstname must be min 3 characters long, contain only letters.
                </div>
          </div>
        </div>
        <div class="form-group">
          <label for="inputSecondName">Second Name</label>
          <input type="text" class="form-control" id="inputSecondName" oninput="checkSecondName()" aria-describedby="inputSecondNameHelp"
            placeholder="Enter second name" pattern="[a-zA-Z]{3,}">
        </div>
        <div class="form-group">
          <label for="inputSurname">Surname</label>
          <input type="text" class="form-control" id="inputSurname" oninput="checkSurname()" required aria-describedby="inputSurnameHelp"
            placeholder="Enter Surname" pattern="^[a-zA-Z][a-zA-Z\-]{1,}[^\-]$">
        </div>
        <div class="form-group">
          <label for="inputPhoneNumber">Phone Number</label>
          <input type="tel" in class="form-control bfh-phone" id="inputPhoneNumber" oninput="checkPhoneNumber()" required
            aria-describedby="inputPhoneNumberHelp" placeholder="Enter phone number" pattern="[0-9]{3} [0-9]{3} [0-9]{3}">
        </div>
        <div class="form-group">
          <label for="selectContactType">Preferred contact form</label>
          <select class="form-control" id="selectContactType" required>
            <!-- <option value="none" selected disabled hidden></option> -->
            <option>Telephone</option>
            <option>Email</option>
          </select>
        </div>
        <div class="form-group">
          <label for="inputFromDate">From Date</label>
          <input type="date" class="form-control" id="inputFromDate" oninput="checkFromDate()" required aria-describedby="inputFromDateHelp"
            placeholder="Enter from date">
        </div>
        <div class="form-group">
          <label for="inputToDate">To Date</label>
          <input type="date" class="form-control" id="inputToDate" oninput="checkToDate()" required aria-describedby="inputToDateHelp"
            placeholder="Enter to date">
        </div>

        <!-- <div class="form-group">
          <label for="inputEmail">Email address</label>
          <input type="email" class="form-control" id="inputEmail" aria-describedby="emailHelp" placeholder="Enter email">
          <small id="emailHelp" class="form-text text-muted">We'll never share your email with anyone else.</small>
        </div>
        <div class="form-group">
          <label for="inputPassword">Password</label>
          <input type="password" class="form-control" id="inputPassword" placeholder="Password">
        </div> -->
        <!-- <div class="form-check">
          <input type="checkbox" class="form-check-input" id="check">
          <label class="form-check-label" for="check">Check me out</label>
        </div> -->
        <button id='submitBtn' type="submit" class="btn btn-primary">Submit</button>
      </form>
    </div>
  </div>

  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://code.jquery.com/jquery-1.12.4.min.js"
    integrity="sha384-nvAa0+6Qg9clwYCGGPpDQLVpLNn0fRaROjHqs13t4Ggj3Ez50XnGQqc/r8MhnRDZ" crossorigin="anonymous"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"
    integrity="sha384-aJ21OjlMXNL5UyIl/XNwTMqvzeRMZH2w8c5cRVpzpU8Y5bApTppSuUkhZXN0VxHd" crossorigin="anonymous"></script>

  <script>
    // Example starter JavaScript for disabling form submissions if there are invalid fields
    (function () {
      'use strict';
      window.addEventListener('load', function () {
        // Fetch all the forms we want to apply custom Bootstrap validation styles to
        var forms = document.getElementsByClassName('needs-validation');
        // Loop over them and prevent submission
        var validation = Array.prototype.filter.call(forms, function (form) {
          form.addEventListener('submit', function (event) {
            if (form.checkValidity() === false) {
              event.preventDefault();
              event.stopPropagation();
              for (var i = 0; i < form.elements.length; i++) {
                var element = form.elements[i];
                console.log(element);
                if (element.checkValidity() === false) {
                  element.focus();
                  break;
                }
              }
            }
            form.classList.add('was-validated');
          }, false);
          Array.prototype.filter.call(form.elements, function (element) {
            element.addEventListener('input', function (event) {
              if (element.checkValidity() === false) {
                element.classList.add('is-invalid');
              } else {
                element.classList.remove('is-invalid');
              }
            }, false);
          });
        });
      }, false);
    })();

    document.getElementById("selectContactType").selectedIndex = -1;

    $.ajax({
      url: "https://api.openweathermap.org/data/2.5/weather?q=Warsaw,POL",
      method: "get",
      dataType: "json",
      data: {
        APPID: 'efb2be66ec5d0327c45efe9ae636b127'
      }
    }).done(function (res) {
      console.log(res); //dostaliśmy odpowiedź z serwera, wypisujemy ją
      var weather = res.weather[0].main;
      weather += ", temp " + Math.round(res.main.temp - 273.15) + "°C"
      console.log(weather);
      document.getElementById("weather").innerHTML = weather
    })

    function checkForm(e) {
      // if (document.getElementById("mainForm").checkValidity() === false) {
      //   document.getElementById("submitBtn").disabled = true;
      // } else {
      //   document.getElementById("submitBtn").disabled = false;
      // }
      // var form = $("#mainForm");
      // form.validate();
      // var isValidForm = form.valid()
      // var isValidForm = document.getElementById("inputFirstname").checkValidity();
      // isValidForm = isValidForm && document.getElementById("inputSecondName").checkValidity();
      // isValidForm = isValidForm && document.getElementById("inputSurname").checkValidity();
      // isValidForm = isValidForm && document.getElementById("inputPhoneNumber").checkValidity();
      // isValidForm = isValidForm && document.getElementById("selectContactType").checkValidity();
      // isValidForm = isValidForm && document.getElementById("inputFromDate").checkValidity();
      // isValidForm = isValidForm && document.getElementById("inputToDate").checkValidity();
      // if (isValidForm) {
      //   document.getElementById("submitBtn").disabled = false;
      // } else {
      //   document.getElementById("submitBtn").disabled = true;
      // }
    }

    function checkPhoneNumber() {
      var value = document.getElementById("inputPhoneNumber").value;
      value = value.replace(/[^0-9]+/g, "");
      values = value.match(/.{1,3}/g);
      if (Array.isArray(values)) {
        value = values.join(" ");
      }
      if (value.length >= 9) {
        value = value.substring(0, 11);
      }
      document.getElementById("inputPhoneNumber").value = value;
      checkForm();
    }

    function checkFirstname() {
      var value = document.getElementById("inputFirstname").value;
      value = value.replace(/[^a-zA-Z]+/g, "");
      document.getElementById("inputFirstname").value = value;
      checkForm();
    }

    function checkSecondName() {
      var value = document.getElementById("inputSecondName").value;
      value = value.replace(/[^a-zA-Z]+/g, "");
      document.getElementById("inputSecondName").value = value;
      checkForm();
    }

    function checkSurname() {
      var value = document.getElementById("inputSurname").value;
      value = value.replace(/[^a-zA-Z\-]+/g, "");
      document.getElementById("inputSurname").value = value;
      checkForm();
    }

    function checkFromDate() {
      var inputFromDate = document.getElementById("inputFromDate").valueAsDate;
      var inputToDate = document.getElementById("inputToDate").valueAsDate;

      if (inputFromDate === null) {
        document.getElementById("inputToDate").setAttribute('min', null);
      } else if (inputToDate === null) {
        document.getElementById("inputToDate").setAttribute('min', inputFromDate.toISOString().substring(0, 10));
      }

      if (inputFromDate !== null && inputToDate !== null) {
        if (inputFromDate > inputToDate) {
          document.getElementById("inputFromDate").value = null;
        }
      }
      checkForm();
    }

    function checkToDate() {
      var inputFromDate = document.getElementById("inputFromDate").valueAsDate;
      var inputToDate = document.getElementById("inputToDate").valueAsDate;

      if (inputToDate === null) {
        document.getElementById("inputFromDate").setAttribute('max', null);
      } else if (inputFromDate === null) {
        document.getElementById("inputFromDate").setAttribute('max', inputToDate.toISOString().substring(0, 10));
      }

      if (inputFromDate !== null && inputToDate !== null) {
        if (inputFromDate > inputToDate) {
          document.getElementById("inputToDate").value = null;
        }

      }
      checkForm();
    }

  </script>



</body>

</html>